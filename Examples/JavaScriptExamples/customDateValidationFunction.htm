<html><head><title>Dates</title></head>
<body>
<!-- You have to use the </script> tag for the following line to work
      <script type="text/javascript" src="DateUtility.js" /> will NOT work -->
<script type="text/javascript">
    function dateValidation() {
        var ret = false;
        if (document.frmDate.txtDate.value == "") {
            alert("Please enter the date");
            document.frmDate.txtDate.focus();
        } else if (validDate(document.frmDate.txtDate.value) == false) {
            alert("Please enter a valid date");
            document.frmDate.txtDate.select();
        } else {
            alert("valid date was entered");
            ret = true;
        }
        return ret;
    }	
	function validDate(d) {
		// can you rewrite this to allow 1/2/09, or 1/2/2009, or 1/02/2009, as well as 01/02/2009?
		// I hope so!
		var v = new String();
		v = d;
		
		var mm = v.substring(0, 2);
		if (isNaN(mm) == true) return false;
		if (mm < 1 || mm > 12) return false;
	
		var dd = v.substring(3, 5);
		if (isNaN(dd) == true) return false;
		if (dd < 1 || dd > 31) return false;
	
		var yyyy = v.substring(6);
		if (isNaN(yyyy) == true) return false;
		if (yyyy < 100 || yyyy > 9999) return false;
	
		return true;
	}	
    function dateValidation2() {
        var ret = false;
        if (document.frmDate2.txtDate.value == "") {
            alert("Please enter the future date");
            document.frmDate2.txtDate.focus();
        } else if (new Date(document.frmDate2.txtDate.value) == "NaN") {
            alert("You must enter a valid date");
            document.frmDate2.txtDate.select();
        } else {
            alert("valid date was entered");
            ret = true;
        }
        return ret;
    }
    function dateValidation3() {
        var ret = false;
        if (document.frmDate3.txtDate.value == "") {
            alert("Please enter the future date");
            document.frmDate3.txtDate.focus();
        } else {
			reDOB = /^\d{2}\/\d{2}\/\d{4}$/;
			// if you want allow 1 digit months and days and 2 or 4 digit years:
			reDOB = /^\d{1,2}\/\d{1,2}\/(\d{2}|\d{4})$/;
			if(!reDOB.test(document.frmDate3.txtDate.value)){
				alert("You must enter a valid date");
				document.frmDate3.txtDate.select();						
			} else {
				alert("valid date was entered");
				ret = true;				
			}
		}
        return ret;
    }
	function dateValidation4() {
        var ret = false;
        if (document.frmDate4.txtDate.value == "") {
            alert("Please enter the future date");
            document.frmDate.txtDate.focus();
        } else {
			// I grabbed this off the web - and no I haven't tried to dissect what it is doing.
			reDOB = /((^(10|12|0?[13578])([/])(3[01]|[12][0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(11|0?[469])([/])(30|[12][0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(0?2)([/])(2[0-8]|1[0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(0?2)([/])(29)([/])([2468][048]00)$)|(^(0?2)([/])(29)([/])([3579][26]00)$)|(^(0?2)([/])(29)([/])([1][89][0][48])$)|(^(0?2)([/])(29)([/])([2-9][0-9][0][48])$)|(^(0?2)([/])(29)([/])([1][89][2468][048])$)|(^(0?2)([/])(29)([/])([2-9][0-9][2468][048])$)|(^(0?2)([/])(29)([/])([1][89][13579][26])$)|(^(0?2)([/])(29)([/])([2-9][0-9][13579][26])$))/;
			if(!reDOB.test(document.frmDate4.txtDate.value)){
				alert("You must enter a valid date");
				document.frmDate4.txtDate.select();						
			} else {
				alert("valid date was entered");
				ret = true;				
			}		}
        return ret;
    }

</script>
<table>
    <form name="frmDate" action="nextPage.htm" onSubmit="return dateValidation();">
        <tr>
            <td align="right">Enter a date in mm/dd/yyyy format:</td>
            <td><input type="text" name="txtDate" size="28" /></td>
            <td></td><td><input type="submit" value="Validate using custom function" /></td>
        </tr>
    </form>
    <form name="frmDate2" action="nextPage.htm" onSubmit="return dateValidation2();">
        <tr>
            <td align="right">Enter a date in mm/dd/yyyy format:</td>
            <td><input type="text" name="txtDate" size="28" /></td>
            <td></td><td><input type="submit" value="Validate using new Date" /></td>
        </tr>
    </form>
    <form name="frmDate3" action="nextPage.htm" onSubmit="return dateValidation3();">    
        <tr>
            <td align="right">Enter a date in mm/dd/yyyy format:</td>
            <td><input type="text" name="txtDate" size="28" /></td>
            <td></td><td><input type="submit" value="Validate using short regular expression" /></td>
        </tr>
    </form>
    <form name="frmDate4" action="nextPage.htm" onSubmit="return dateValidation4();">
        <tr>
            <td align="right">Enter a date in mm/dd/yyyy format:</td>
            <td><input type="text" name="txtDate" size="28" /></td>
            <td></td><td><input type="submit" value="Validate using more complete regular expression" /></td>
        </tr>
    </form>
</table>

</body>
</html>
<script type="text/javascript">

</script>